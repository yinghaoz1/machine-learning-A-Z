\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Part 7 Natural Language Processing},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Part 7 Natural Language Processing}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{}
    \preauthor{}\postauthor{}
    \date{}
    \predate{}\postdate{}
  

\begin{document}
\maketitle

Natural language processing (NLP) is an area of computer science and
artificial intelligence concerned with the interactions between
computers and human (natural) languages. NLP is used to apply machine
learning models to text and language.

\hypertarget{text-preprocessing}{%
\subsection{7.1 Text Preprocessing}\label{text-preprocessing}}

\texttt{quote\ =\ \textquotesingle{}\textquotesingle{}} means ignoring
any quotes in the text. \texttt{stringsAsFactors\ =\ FALSE} means we do
not consider \texttt{Review} as a factor.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Importing the dataset}
\NormalTok{dataset_original =}\StringTok{ }\KeywordTok{read.delim}\NormalTok{(}\StringTok{'Restaurant_Reviews.tsv'}\NormalTok{, }\DataTypeTok{quote =} \StringTok{''}\NormalTok{, }\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{head}\NormalTok{(dataset_original)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                                                                                    Review
## 1                                                                Wow... Loved this place.
## 2                                                                      Crust is not good.
## 3                                               Not tasty and the texture was just nasty.
## 4 Stopped by during the late May bank holiday off Rick Steve recommendation and loved it.
## 5                             The selection on the menu was great and so were the prices.
## 6                                          Now I am getting angry and I want my damn pho.
##   Liked
## 1     1
## 2     0
## 3     0
## 4     1
## 5     1
## 6     0
\end{verbatim}

Here are the text cleaning steps: - \textbf{STEP 1}: Make all words
lowercase. - \textbf{STEP 2}: Remove all numbers in the text. -
\textbf{STEP 3}: Remove all punctuations in the text. - \textbf{STEP 4}:
Remove all stop words in the text. - \textbf{STEP 5}: Stemming, or
taking the root of the word. - \textbf{STEP 6}: Remove redundant white
space.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Cleaning the texts}
\KeywordTok{library}\NormalTok{(tm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: NLP
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(SnowballC)}
\NormalTok{corpus =}\StringTok{ }\KeywordTok{VCorpus}\NormalTok{(}\KeywordTok{VectorSource}\NormalTok{(dataset_original}\OperatorTok{$}\NormalTok{Review))}
\NormalTok{corpus =}\StringTok{ }\KeywordTok{tm_map}\NormalTok{(corpus, }\KeywordTok{content_transformer}\NormalTok{(tolower))}
\NormalTok{corpus =}\StringTok{ }\KeywordTok{tm_map}\NormalTok{(corpus, removeNumbers)}
\NormalTok{corpus =}\StringTok{ }\KeywordTok{tm_map}\NormalTok{(corpus, removePunctuation)}
\NormalTok{corpus =}\StringTok{ }\KeywordTok{tm_map}\NormalTok{(corpus, removeWords, }\KeywordTok{stopwords}\NormalTok{())}
\NormalTok{corpus =}\StringTok{ }\KeywordTok{tm_map}\NormalTok{(corpus, stemDocument)}
\NormalTok{corpus =}\StringTok{ }\KeywordTok{tm_map}\NormalTok{(corpus, stripWhitespace)}
\KeywordTok{as.character}\NormalTok{(corpus[[}\DecValTok{1}\NormalTok{]])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "wow love place"
\end{verbatim}

The bag of words model will create a sparse matrix \texttt{X} with the
column including each word, the row including each review, and the cell
including the occurence of each word in each review.

In \texttt{removeSparseTerms}, we need to specify: - \texttt{sparse}: A
numeric for the maximal allowed sparsity in the range from bigger zero
to smaller one.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Creating the bag of words model and filtering the non-frequent words}
\NormalTok{dtm =}\StringTok{ }\KeywordTok{DocumentTermMatrix}\NormalTok{(corpus)}
\NormalTok{dtm =}\StringTok{ }\KeywordTok{removeSparseTerms}\NormalTok{(dtm, }\FloatTok{0.999}\NormalTok{)}
\NormalTok{dtm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## <<DocumentTermMatrix (documents: 1000, terms: 691)>>
## Non-/sparse entries: 4549/686451
## Sparsity           : 99%
## Maximal term length: 12
## Weighting          : term frequency (tf)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Converting dtm to the dataset}
\NormalTok{dataset =}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(dtm))}
\NormalTok{dataset}\OperatorTok{$}\NormalTok{Liked =}\StringTok{ }\NormalTok{dataset_original}\OperatorTok{$}\NormalTok{Liked}
\KeywordTok{head}\NormalTok{(dataset)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   absolut acknowledg actual ago almost also although alway amaz ambianc
## 1       0          0      0   0      0    0        0     0    0       0
## 2       0          0      0   0      0    0        0     0    0       0
## 3       0          0      0   0      0    0        0     0    0       0
## 4       0          0      0   0      0    0        0     0    0       0
## 5       0          0      0   0      0    0        0     0    0       0
## 6       0          0      0   0      0    0        0     0    0       0
##   ambienc amount anoth anyon anyth anytim anyway apolog appet area arent
## 1       0      0     0     0     0      0      0      0     0    0     0
## 2       0      0     0     0     0      0      0      0     0    0     0
## 3       0      0     0     0     0      0      0      0     0    0     0
## 4       0      0     0     0     0      0      0      0     0    0     0
## 5       0      0     0     0     0      0      0      0     0    0     0
## 6       0      0     0     0     0      0      0      0     0    0     0
##   around arriv ask assur ate atmospher attack attent attitud authent
## 1      0     0   0     0   0         0      0      0       0       0
## 2      0     0   0     0   0         0      0      0       0       0
## 3      0     0   0     0   0         0      0      0       0       0
## 4      0     0   0     0   0         0      0      0       0       0
## 5      0     0   0     0   0         0      0      0       0       0
## 6      0     0   0     0   0         0      0      0       0       0
##   averag avoid away awesom awkward babi bachi back bacon bad bagel bakeri
## 1      0     0    0      0       0    0     0    0     0   0     0      0
## 2      0     0    0      0       0    0     0    0     0   0     0      0
## 3      0     0    0      0       0    0     0    0     0   0     0      0
## 4      0     0    0      0       0    0     0    0     0   0     0      0
## 5      0     0    0      0       0    0     0    0     0   0     0      0
## 6      0     0    0      0       0    0     0    0     0   0     0      0
##   bar bare bartend basic bathroom batter bay bean beat beauti becom beef
## 1   0    0       0     0        0      0   0    0    0      0     0    0
## 2   0    0       0     0        0      0   0    0    0      0     0    0
## 3   0    0       0     0        0      0   0    0    0      0     0    0
## 4   0    0       0     0        0      0   0    0    0      0     0    0
## 5   0    0       0     0        0      0   0    0    0      0     0    0
## 6   0    0       0     0        0      0   0    0    0      0     0    0
##   beer behind believ belli best better beyond big bill biscuit bisqu bit
## 1    0      0      0     0    0      0      0   0    0       0     0   0
## 2    0      0      0     0    0      0      0   0    0       0     0   0
## 3    0      0      0     0    0      0      0   0    0       0     0   0
## 4    0      0      0     0    0      0      0   0    0       0     0   0
## 5    0      0      0     0    0      0      0   0    0       0     0   0
## 6    0      0      0     0    0      0      0   0    0       0     0   0
##   bite black bland blow boba boot bother bowl box boy boyfriend bread
## 1    0     0     0    0    0    0      0    0   0   0         0     0
## 2    0     0     0    0    0    0      0    0   0   0         0     0
## 3    0     0     0    0    0    0      0    0   0   0         0     0
## 4    0     0     0    0    0    0      0    0   0   0         0     0
## 5    0     0     0    0    0    0      0    0   0   0         0     0
## 6    0     0     0    0    0    0      0    0   0   0         0     0
##   break breakfast brick bring brought brunch buck buffet build burger busi
## 1     0         0     0     0       0      0    0      0     0      0    0
## 2     0         0     0     0       0      0    0      0     0      0    0
## 3     0         0     0     0       0      0    0      0     0      0    0
## 4     0         0     0     0       0      0    0      0     0      0    0
## 5     0         0     0     0       0      0    0      0     0      0    0
## 6     0         0     0     0       0      0    0      0     0      0    0
##   butter cafe call came can cant car care cashier char charcoal charg
## 1      0    0    0    0   0    0   0    0       0    0        0     0
## 2      0    0    0    0   0    0   0    0       0    0        0     0
## 3      0    0    0    0   0    0   0    0       0    0        0     0
## 4      0    0    0    0   0    0   0    0       0    0        0     0
## 5      0    0    0    0   0    0   0    0       0    0        0     0
## 6      0    0    0    0   0    0   0    0       0    0        0     0
##   cheap check chees cheeseburg chef chewi chicken chines chip choos
## 1     0     0     0          0    0     0       0      0    0     0
## 2     0     0     0          0    0     0       0      0    0     0
## 3     0     0     0          0    0     0       0      0    0     0
## 4     0     0     0          0    0     0       0      0    0     0
## 5     0     0     0          0    0     0       0      0    0     0
## 6     0     0     0          0    0     0       0      0    0     0
##   classic clean close cocktail coffe cold color combin combo come comfort
## 1       0     0     0        0     0    0     0      0     0    0       0
## 2       0     0     0        0     0    0     0      0     0    0       0
## 3       0     0     0        0     0    0     0      0     0    0       0
## 4       0     0     0        0     0    0     0      0     0    0       0
## 5       0     0     0        0     0    0     0      0     0    0       0
## 6       0     0     0        0     0    0     0      0     0    0       0
##   compani complain complaint complet consid contain conveni cook cool
## 1       0        0         0       0      0       0       0    0    0
## 2       0        0         0       0      0       0       0    0    0
## 3       0        0         0       0      0       0       0    0    0
## 4       0        0         0       0      0       0       0    0    0
## 5       0        0         0       0      0       0       0    0    0
## 6       0        0         0       0      0       0       0    0    0
##   correct couldnt coupl cours cover cow crazi cream creami crowd crust
## 1       0       0     0     0     0   0     0     0      0     0     0
## 2       0       0     0     0     0   0     0     0      0     0     1
## 3       0       0     0     0     0   0     0     0      0     0     0
## 4       0       0     0     0     0   0     0     0      0     0     0
## 5       0       0     0     0     0   0     0     0      0     0     0
## 6       0       0     0     0     0   0     0     0      0     0     0
##   curri custom cut cute damn dark date day deal decent decid decor defin
## 1     0      0   0    0    0    0    0   0    0      0     0     0     0
## 2     0      0   0    0    0    0    0   0    0      0     0     0     0
## 3     0      0   0    0    0    0    0   0    0      0     0     0     0
## 4     0      0   0    0    0    0    0   0    0      0     0     0     0
## 5     0      0   0    0    0    0    0   0    0      0     0     0     0
## 6     0      0   0    0    1    0    0   0    0      0     0     0     0
##   definit delici delight delish deserv dessert didnt die differ dine
## 1       0      0       0      0      0       0     0   0      0    0
## 2       0      0       0      0      0       0     0   0      0    0
## 3       0      0       0      0      0       0     0   0      0    0
## 4       0      0       0      0      0       0     0   0      0    0
## 5       0      0       0      0      0       0     0   0      0    0
## 6       0      0       0      0      0       0     0   0      0    0
##   dinner dirt dirti disappoint disgrac disgust dish disrespect dog done
## 1      0    0     0          0       0       0    0          0   0    0
## 2      0    0     0          0       0       0    0          0   0    0
## 3      0    0     0          0       0       0    0          0   0    0
## 4      0    0     0          0       0       0    0          0   0    0
## 5      0    0     0          0       0       0    0          0   0    0
## 6      0    0     0          0       0       0    0          0   0    0
##   dont door doubl doubt downtown dress dri driest drink drive duck eat
## 1    0    0     0     0        0     0   0      0     0     0    0   0
## 2    0    0     0     0        0     0   0      0     0     0    0   0
## 3    0    0     0     0        0     0   0      0     0     0    0   0
## 4    0    0     0     0        0     0   0      0     0     0    0   0
## 5    0    0     0     0        0     0   0      0     0     0    0   0
## 6    0    0     0     0        0     0   0      0     0     0    0   0
##   eaten edibl egg eggplant either els elsewher employe empti end enjoy
## 1     0     0   0        0      0   0        0       0     0   0     0
## 2     0     0   0        0      0   0        0       0     0   0     0
## 3     0     0   0        0      0   0        0       0     0   0     0
## 4     0     0   0        0      0   0        0       0     0   0     0
## 5     0     0   0        0      0   0        0       0     0   0     0
## 6     0     0   0        0      0   0        0       0     0   0     0
##   enough entre equal especi establish even event ever everi everyon
## 1      0     0     0      0         0    0     0    0     0       0
## 2      0     0     0      0         0    0     0    0     0       0
## 3      0     0     0      0         0    0     0    0     0       0
## 4      0     0     0      0         0    0     0    0     0       0
## 5      0     0     0      0         0    0     0    0     0       0
## 6      0     0     0      0         0    0     0    0     0       0
##   everyth excel excus expect experi experienc extra extrem eye fact fail
## 1       0     0     0      0      0         0     0      0   0    0    0
## 2       0     0     0      0      0         0     0      0   0    0    0
## 3       0     0     0      0      0         0     0      0   0    0    0
## 4       0     0     0      0      0         0     0      0   0    0    0
## 5       0     0     0      0      0         0     0      0   0    0    0
## 6       0     0     0      0      0         0     0      0   0    0    0
##   fair famili familiar fan fantast far fare fast favor favorit feel fell
## 1    0      0        0   0       0   0    0    0     0       0    0    0
## 2    0      0        0   0       0   0    0    0     0       0    0    0
## 3    0      0        0   0       0   0    0    0     0       0    0    0
## 4    0      0        0   0       0   0    0    0     0       0    0    0
## 5    0      0        0   0       0   0    0    0     0       0    0    0
## 6    0      0        0   0       0   0    0    0     0       0    0    0
##   felt filet fill final find fine finish first fish flavor flavorless
## 1    0     0    0     0    0    0      0     0    0      0          0
## 2    0     0    0     0    0    0      0     0    0      0          0
## 3    0     0    0     0    0    0      0     0    0      0          0
## 4    0     0    0     0    0    0      0     0    0      0          0
## 5    0     0    0     0    0    0      0     0    0      0          0
## 6    0     0    0     0    0    0      0     0    0      0          0
##   flower focus folk food found fresh fri friend front frozen full fun
## 1      0     0    0    0     0     0   0      0     0      0    0   0
## 2      0     0    0    0     0     0   0      0     0      0    0   0
## 3      0     0    0    0     0     0   0      0     0      0    0   0
## 4      0     0    0    0     0     0   0      0     0      0    0   0
## 5      0     0    0    0     0     0   0      0     0      0    0   0
## 6      0     0    0    0     0     0   0      0     0      0    0   0
##   garlic gave generous get give given glad gold gone good got greas great
## 1      0    0        0   0    0     0    0    0    0    0   0     0     0
## 2      0    0        0   0    0     0    0    0    0    1   0     0     0
## 3      0    0        0   0    0     0    0    0    0    0   0     0     0
## 4      0    0        0   0    0     0    0    0    0    0   0     0     0
## 5      0    0        0   0    0     0    0    0    0    0   0     0     1
## 6      0    0        0   1    0     0    0    0    0    0   0     0     0
##   greek green greet grill gross group guess guest guy gyro hair half hand
## 1     0     0     0     0     0     0     0     0   0    0    0    0    0
## 2     0     0     0     0     0     0     0     0   0    0    0    0    0
## 3     0     0     0     0     0     0     0     0   0    0    0    0    0
## 4     0     0     0     0     0     0     0     0   0    0    0    0    0
## 5     0     0     0     0     0     0     0     0   0    0    0    0    0
## 6     0     0     0     0     0     0     0     0   0    0    0    0    0
##   handl happen happi hard hate head healthi heard heart heat help high
## 1     0      0     0    0    0    0       0     0     0    0    0    0
## 2     0      0     0    0    0    0       0     0     0    0    0    0
## 3     0      0     0    0    0    0       0     0     0    0    0    0
## 4     0      0     0    0    0    0       0     0     0    0    0    0
## 5     0      0     0    0    0    0       0     0     0    0    0    0
## 6     0      0     0    0    0    0       0     0     0    0    0    0
##   highlight hit home homemad honest hope horribl hot hour hous howev huge
## 1         0   0    0       0      0    0       0   0    0    0     0    0
## 2         0   0    0       0      0    0       0   0    0    0     0    0
## 3         0   0    0       0      0    0       0   0    0    0     0    0
## 4         0   0    0       0      0    0       0   0    0    0     0    0
## 5         0   0    0       0      0    0       0   0    0    0     0    0
## 6         0   0    0       0      0    0       0   0    0    0     0    0
##   human hummus husband ice ignor ill imagin immedi impecc impress includ
## 1     0      0       0   0     0   0      0      0      0       0      0
## 2     0      0       0   0     0   0      0      0      0       0      0
## 3     0      0       0   0     0   0      0      0      0       0      0
## 4     0      0       0   0     0   0      0      0      0       0      0
## 5     0      0       0   0     0   0      0      0      0       0      0
## 6     0      0       0   0     0   0      0      0      0       0      0
##   incred indian inexpens insid insult interest isnt italian ive job joint
## 1      0      0        0     0      0        0    0       0   0   0     0
## 2      0      0        0     0      0        0    0       0   0   0     0
## 3      0      0        0     0      0        0    0       0   0   0     0
## 4      0      0        0     0      0        0    0       0   0   0     0
## 5      0      0        0     0      0        0    0       0   0   0     0
## 6      0      0        0     0      0        0    0       0   0   0     0
##   joke judg just kept kid kind know known lack ladi larg last late later
## 1    0    0    0    0   0    0    0     0    0    0    0    0    0     0
## 2    0    0    0    0   0    0    0     0    0    0    0    0    0     0
## 3    0    0    1    0   0    0    0     0    0    0    0    0    0     0
## 4    0    0    0    0   0    0    0     0    0    0    0    0    1     0
## 5    0    0    0    0   0    0    0     0    0    0    0    0    0     0
## 6    0    0    0    0   0    0    0     0    0    0    0    0    0     0
##   least leav left legit let life light like list liter littl live lobster
## 1     0    0    0     0   0    0     0    0    0     0     0    0       0
## 2     0    0    0     0   0    0     0    0    0     0     0    0       0
## 3     0    0    0     0   0    0     0    0    0     0     0    0       0
## 4     0    0    0     0   0    0     0    0    0     0     0    0       0
## 5     0    0    0     0   0    0     0    0    0     0     0    0       0
## 6     0    0    0     0   0    0     0    0    0     0     0    0       0
##   locat long longer look lost lot love lover lukewarm lunch made main make
## 1     0    0      0    0    0   0    1     0        0     0    0    0    0
## 2     0    0      0    0    0   0    0     0        0     0    0    0    0
## 3     0    0      0    0    0   0    0     0        0     0    0    0    0
## 4     0    0      0    0    0   0    1     0        0     0    0    0    0
## 5     0    0      0    0    0   0    0     0        0     0    0    0    0
## 6     0    0      0    0    0   0    0     0        0     0    0    0    0
##   mall manag mani margarita mari may mayb meal mean meat mediocr meh melt
## 1    0     0    0         0    0   0    0    0    0    0       0   0    0
## 2    0     0    0         0    0   0    0    0    0    0       0   0    0
## 3    0     0    0         0    0   0    0    0    0    0       0   0    0
## 4    0     0    0         0    0   1    0    0    0    0       0   0    0
## 5    0     0    0         0    0   0    0    0    0    0       0   0    0
## 6    0     0    0         0    0   0    0    0    0    0       0   0    0
##   menu mexican mid min mind minut miss mistak moist mom money mood mouth
## 1    0       0   0   0    0     0    0      0     0   0     0    0     0
## 2    0       0   0   0    0     0    0      0     0   0     0    0     0
## 3    0       0   0   0    0     0    0      0     0   0     0    0     0
## 4    0       0   0   0    0     0    0      0     0   0     0    0     0
## 5    1       0   0   0    0     0    0      0     0   0     0    0     0
## 6    0       0   0   0    0     0    0      0     0   0     0    0     0
##   much multipl mushroom music must nacho nasti need needless neighborhood
## 1    0       0        0     0    0     0     0    0        0            0
## 2    0       0        0     0    0     0     0    0        0            0
## 3    0       0        0     0    0     0     1    0        0            0
## 4    0       0        0     0    0     0     0    0        0            0
## 5    0       0        0     0    0     0     0    0        0            0
## 6    0       0        0     0    0     0     0    0        0            0
##   never new next nice nicest night none note noth now offer old omg one
## 1     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 2     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 3     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 4     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 5     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 6     0   0    0    0      0     0    0    0    0   1     0   0   0   0
##   opportun option order other outsid outstand oven overal overcook overpr
## 1        0      0     0     0      0        0    0      0        0      0
## 2        0      0     0     0      0        0    0      0        0      0
## 3        0      0     0     0      0        0    0      0        0      0
## 4        0      0     0     0      0        0    0      0        0      0
## 5        0      0     0     0      0        0    0      0        0      0
## 6        0      0     0     0      0        0    0      0        0      0
##   overwhelm owner pace pack paid pancak paper par part parti pass pasta
## 1         0     0    0    0    0      0     0   0    0     0    0     0
## 2         0     0    0    0    0      0     0   0    0     0    0     0
## 3         0     0    0    0    0      0     0   0    0     0    0     0
## 4         0     0    0    0    0      0     0   0    0     0    0     0
## 5         0     0    0    0    0      0     0   0    0     0    0     0
## 6         0     0    0    0    0      0     0   0    0     0    0     0
##   patio pay peanut peopl perfect person pho phoenix pictur piec pita pizza
## 1     0   0      0     0       0      0   0       0      0    0    0     0
## 2     0   0      0     0       0      0   0       0      0    0    0     0
## 3     0   0      0     0       0      0   0       0      0    0    0     0
## 4     0   0      0     0       0      0   0       0      0    0    0     0
## 5     0   0      0     0       0      0   0       0      0    0    0     0
## 6     0   0      0     0       0      0   1       0      0    0    0     0
##   place plate play pleas pleasant plus point poor pop pork portion possibl
## 1     1     0    0     0        0    0     0    0   0    0       0       0
## 2     0     0    0     0        0    0     0    0   0    0       0       0
## 3     0     0    0     0        0    0     0    0   0    0       0       0
## 4     0     0    0     0        0    0     0    0   0    0       0       0
## 5     0     0    0     0        0    0     0    0   0    0       0       0
## 6     0     0    0     0        0    0     0    0   0    0       0       0
##   potato prepar present pretti price probabl profession promis prompt
## 1      0      0       0      0     0       0          0      0      0
## 2      0      0       0      0     0       0          0      0      0
## 3      0      0       0      0     0       0          0      0      0
## 4      0      0       0      0     0       0          0      0      0
## 5      0      0       0      0     1       0          0      0      0
## 6      0      0       0      0     0       0          0      0      0
##   provid public pull pure put qualiti quick quit rare rate rather rave
## 1      0      0    0    0   0       0     0    0    0    0      0    0
## 2      0      0    0    0   0       0     0    0    0    0      0    0
## 3      0      0    0    0   0       0     0    0    0    0      0    0
## 4      0      0    0    0   0       0     0    0    0    0      0    0
## 5      0      0    0    0   0       0     0    0    0    0      0    0
## 6      0      0    0    0   0       0     0    0    0    0      0    0
##   read real realiz realli reason receiv recent recommend red refil regular
## 1    0    0      0      0      0      0      0         0   0     0       0
## 2    0    0      0      0      0      0      0         0   0     0       0
## 3    0    0      0      0      0      0      0         0   0     0       0
## 4    0    0      0      0      0      0      0         1   0     0       0
## 5    0    0      0      0      0      0      0         0   0     0       0
## 6    0    0      0      0      0      0      0         0   0     0       0
##   relax remind restaur return review rice right roast roll room rude run
## 1     0      0       0      0      0    0     0     0    0    0    0   0
## 2     0      0       0      0      0    0     0     0    0    0    0   0
## 3     0      0       0      0      0    0     0     0    0    0    0   0
## 4     0      0       0      0      0    0     0     0    0    0    0   0
## 5     0      0       0      0      0    0     0     0    0    0    0   0
## 6     0      0       0      0      0    0     0     0    0    0    0   0
##   sad said salad salmon salsa salt sandwich sashimi sat satisfi sauc say
## 1   0    0     0      0     0    0        0       0   0       0    0   0
## 2   0    0     0      0     0    0        0       0   0       0    0   0
## 3   0    0     0      0     0    0        0       0   0       0    0   0
## 4   0    0     0      0     0    0        0       0   0       0    0   0
## 5   0    0     0      0     0    0        0       0   0       0    0   0
## 6   0    0     0      0     0    0        0       0   0       0    0   0
##   scallop seafood season seat second see seem seen select serious serv
## 1       0       0      0    0      0   0    0    0      0       0    0
## 2       0       0      0    0      0   0    0    0      0       0    0
## 3       0       0      0    0      0   0    0    0      0       0    0
## 4       0       0      0    0      0   0    0    0      0       0    0
## 5       0       0      0    0      0   0    0    0      1       0    0
## 6       0       0      0    0      0   0    0    0      0       0    0
##   server servic set sever shop show shrimp sick side sign similar simpl
## 1      0      0   0     0    0    0      0    0    0    0       0     0
## 2      0      0   0     0    0    0      0    0    0    0       0     0
## 3      0      0   0     0    0    0      0    0    0    0       0     0
## 4      0      0   0     0    0    0      0    0    0    0       0     0
## 5      0      0   0     0    0    0      0    0    0    0       0     0
## 6      0      0   0     0    0    0      0    0    0    0       0     0
##   simpli sinc singl sit six slice slow small smell soggi someon someth
## 1      0    0     0   0   0     0    0     0     0     0      0      0
## 2      0    0     0   0   0     0    0     0     0     0      0      0
## 3      0    0     0   0   0     0    0     0     0     0      0      0
## 4      0    0     0   0   0     0    0     0     0     0      0      0
## 5      0    0     0   0   0     0    0     0     0     0      0      0
## 6      0    0     0   0   0     0    0     0     0     0      0      0
##   soon soooo sore soup special spend spice spici spot staff stale star
## 1    0     0    0    0       0     0     0     0    0     0     0    0
## 2    0     0    0    0       0     0     0     0    0     0     0    0
## 3    0     0    0    0       0     0     0     0    0     0     0    0
## 4    0     0    0    0       0     0     0     0    0     0     0    0
## 5    0     0    0    0       0     0     0     0    0     0     0    0
## 6    0     0    0    0       0     0     0     0    0     0     0    0
##   start station stay steak step stick still stir stomach stop strip stuf
## 1     0       0    0     0    0     0     0    0       0    0     0    0
## 2     0       0    0     0    0     0     0    0       0    0     0    0
## 3     0       0    0     0    0     0     0    0       0    0     0    0
## 4     0       0    0     0    0     0     0    0       0    1     0    0
## 5     0       0    0     0    0     0     0    0       0    0     0    0
## 6     0       0    0     0    0     0     0    0       0    0     0    0
##   stuff style subpar subway suck sugari suggest summer super sure surpris
## 1     0     0      0      0    0      0       0      0     0    0       0
## 2     0     0      0      0    0      0       0      0     0    0       0
## 3     0     0      0      0    0      0       0      0     0    0       0
## 4     0     0      0      0    0      0       0      0     0    0       0
## 5     0     0      0      0    0      0       0      0     0    0       0
## 6     0     0      0      0    0      0       0      0     0    0       0
##   sushi sweet tabl taco take talk tap tapa tartar tast tasteless tasti tea
## 1     0     0    0    0    0    0   0    0      0    0         0     0   0
## 2     0     0    0    0    0    0   0    0      0    0         0     0   0
## 3     0     0    0    0    0    0   0    0      0    0         0     1   0
## 4     0     0    0    0    0    0   0    0      0    0         0     0   0
## 5     0     0    0    0    0    0   0    0      0    0         0     0   0
## 6     0     0    0    0    0    0   0    0      0    0         0     0   0
##   tell ten tender terribl textur thai that thin thing think third though
## 1    0   0      0       0      0    0    0    0     0     0     0      0
## 2    0   0      0       0      0    0    0    0     0     0     0      0
## 3    0   0      0       0      1    0    0    0     0     0     0      0
## 4    0   0      0       0      0    0    0    0     0     0     0      0
## 5    0   0      0       0      0    0    0    0     0     0     0      0
## 6    0   0      0       0      0    0    0    0     0     0     0      0
##   thought thumb time tip toast today told took top tot total touch toward
## 1       0     0    0   0     0     0    0    0   0   0     0     0      0
## 2       0     0    0   0     0     0    0    0   0   0     0     0      0
## 3       0     0    0   0     0     0    0    0   0   0     0     0      0
## 4       0     0    0   0     0     0    0    0   0   0     0     0      0
## 5       0     0    0   0     0     0    0    0   0   0     0     0      0
## 6       0     0    0   0     0     0    0    0   0   0     0     0      0
##   town treat tri trip tuna twice two unbeliev undercook underwhelm
## 1    0     0   0    0    0     0   0        0         0          0
## 2    0     0   0    0    0     0   0        0         0          0
## 3    0     0   0    0    0     0   0        0         0          0
## 4    0     0   0    0    0     0   0        0         0          0
## 5    0     0   0    0    0     0   0        0         0          0
## 6    0     0   0    0    0     0   0        0         0          0
##   unfortun unless use valley valu vega veget vegetarian ventur vibe
## 1        0      0   0      0    0    0     0          0      0    0
## 2        0      0   0      0    0    0     0          0      0    0
## 3        0      0   0      0    0    0     0          0      0    0
## 4        0      0   0      0    0    0     0          0      0    0
## 5        0      0   0      0    0    0     0          0      0    0
## 6        0      0   0      0    0    0     0          0      0    0
##   vinegrett visit wait waiter waitress walk wall want warm wasnt wast
## 1         0     0    0      0        0    0    0    0    0     0    0
## 2         0     0    0      0        0    0    0    0    0     0    0
## 3         0     0    0      0        0    0    0    0    0     0    0
## 4         0     0    0      0        0    0    0    0    0     0    0
## 5         0     0    0      0        0    0    0    0    0     0    0
## 6         0     0    0      0        0    0    0    1    0     0    0
##   watch water way week well went weve white whole wife will wine wing
## 1     0     0   0    0    0    0    0     0     0    0    0    0    0
## 2     0     0   0    0    0    0    0     0     0    0    0    0    0
## 3     0     0   0    0    0    0    0     0     0    0    0    0    0
## 4     0     0   0    0    0    0    0     0     0    0    0    0    0
## 5     0     0   0    0    0    0    0     0     0    0    0    0    0
## 6     0     0   0    0    0    0    0     0     0    0    0    0    0
##   without wonder wont word work worker world wors worst worth wouldnt wow
## 1       0      0    0    0    0      0     0    0     0     0       0   1
## 2       0      0    0    0    0      0     0    0     0     0       0   0
## 3       0      0    0    0    0      0     0    0     0     0       0   0
## 4       0      0    0    0    0      0     0    0     0     0       0   0
## 5       0      0    0    0    0      0     0    0     0     0       0   0
## 6       0      0    0    0    0      0     0    0     0     0       0   0
##   wrap wrong year yet youd your yummi zero Liked
## 1    0     0    0   0    0    0     0    0     1
## 2    0     0    0   0    0    0     0    0     0
## 3    0     0    0   0    0    0     0    0     0
## 4    0     0    0   0    0    0     0    0     1
## 5    0     0    0   0    0    0     0    0     1
## 6    0     0    0   0    0    0     0    0     0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Encoding the target feature as factor}
\NormalTok{dataset}\OperatorTok{$}\NormalTok{Liked =}\StringTok{ }\KeywordTok{factor}\NormalTok{(dataset}\OperatorTok{$}\NormalTok{Liked, }\DataTypeTok{levels =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Splitting the dataset into the training and test set}
\KeywordTok{library}\NormalTok{(caTools)}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{split =}\StringTok{ }\KeywordTok{sample.split}\NormalTok{(dataset}\OperatorTok{$}\NormalTok{Liked, }\DataTypeTok{SplitRatio =} \FloatTok{0.8}\NormalTok{)}
\NormalTok{training_set =}\StringTok{ }\KeywordTok{subset}\NormalTok{(dataset, split }\OperatorTok{==}\StringTok{ }\OtherTok{TRUE}\NormalTok{)}
\NormalTok{test_set =}\StringTok{ }\KeywordTok{subset}\NormalTok{(dataset, split }\OperatorTok{==}\StringTok{ }\OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{classification-model-selection}{%
\subsection{7.2 Classification Model
Selection}\label{classification-model-selection}}

\hypertarget{logistic-regression}{%
\subsubsection{7.2.1 Logistic Regression}\label{logistic-regression}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Fitting logistic regression to the training set}
\NormalTok{classifier =}\StringTok{ }\KeywordTok{glm}\NormalTok{(}\DataTypeTok{formula =}\NormalTok{ Liked }\OperatorTok{~}\StringTok{ }\NormalTok{., }
                 \DataTypeTok{family =}\NormalTok{ binomial, }
                 \DataTypeTok{data =}\NormalTok{ training_set)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Predicting the test set results}
\NormalTok{prob_pred =}\StringTok{ }\KeywordTok{predict}\NormalTok{(classifier, }\DataTypeTok{type =} \StringTok{'response'}\NormalTok{, }\DataTypeTok{newdata =}\NormalTok{ test_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type
## == : prediction from a rank-deficient fit may be misleading
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y_pred =}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(prob_pred }\OperatorTok{>}\StringTok{ }\FloatTok{0.5}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{y_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   4   9  10  16  17  21  24  33  39  40  41  48  56  58  59  61  63  73 
##   1   1   1   0   0   0   0   0   0   0   0   1   0   1   1   0   0   1 
##  76  82  92  93  98  99 105 112 113 115 116 122 123 142 150 152 154 157 
##   0   1   0   1   0   1   0   0   1   1   0   0   0   1   0   0   0   1 
## 158 159 161 169 182 183 184 188 190 191 193 199 202 203 210 211 217 222 
##   0   1   1   1   0   1   0   1   0   1   0   1   1   0   0   0   1   0 
## 228 239 240 250 251 255 258 262 264 270 272 276 287 292 303 306 314 318 
##   1   1   0   0   1   1   0   1   1   1   1   1   1   0   0   1   0   1 
## 326 328 337 344 345 346 349 351 353 361 363 364 370 375 395 396 397 399 
##   0   1   1   1   0   1   1   0   1   0   1   1   0   1   1   1   0   1 
## 412 413 415 416 430 433 445 446 453 456 466 469 470 473 486 495 496 509 
##   1   1   0   0   1   1   1   0   1   0   1   1   0   0   0   1   0   0 
## 519 521 525 528 531 535 539 545 548 555 560 563 568 570 574 583 586 591 
##   1   0   0   0   1   0   0   1   1   1   1   1   1   1   0   1   1   0 
## 598 606 613 614 618 625 628 633 634 639 641 647 648 653 658 668 674 679 
##   1   1   1   1   1   1   1   0   1   1   1   0   1   0   1   0   0   1 
## 688 694 698 712 715 716 719 730 739 743 752 759 761 768 780 789 795 807 
##   1   1   0   1   1   0   1   0   0   1   1   1   1   1   1   1   1   0 
## 809 811 817 818 821 844 848 849 853 855 863 868 874 882 890 891 892 894 
##   1   1   0   0   1   0   1   1   0   1   1   1   0   0   0   0   1   1 
## 900 905 906 912 915 920 924 931 935 938 939 941 953 956 965 973 977 983 
##   1   0   1   0   0   1   1   0   1   0   0   0   1   0   0   1   0   1 
## 985 996 
##   0   1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Making the confusion matrix}
\NormalTok{cm =}\StringTok{ }\KeywordTok{table}\NormalTok{(test_set[, }\DecValTok{692}\NormalTok{], y_pred)}
\NormalTok{cm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y_pred
##      0  1
##   0 49 51
##   1 39 61
\end{verbatim}

\hypertarget{k-nn}{%
\subsubsection{7.2.2 K-NN}\label{k-nn}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Fitting K-NN to the training set and predicing the test set results}
\KeywordTok{library}\NormalTok{(class)}
\NormalTok{y_pred =}\StringTok{ }\KeywordTok{knn}\NormalTok{(}\DataTypeTok{train =}\NormalTok{ training_set[, }\DecValTok{-692}\NormalTok{], }
             \DataTypeTok{test =}\NormalTok{ test_set[, }\DecValTok{-692}\NormalTok{], }
             \DataTypeTok{cl =}\NormalTok{ training_set[, }\DecValTok{692}\NormalTok{], }
             \DataTypeTok{k =} \DecValTok{5}\NormalTok{)}
\NormalTok{y_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 1 1 1 0 0 0 0 1 0 0 0 1 1 0 0 0 1 0 0 1 0 0 1 1 0 0 1 1 0 0 1 1 0 1 0
##  [36] 0 1 1 0 0 0 0 0 0 1 1 1 1 1 0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 1 0 0 0 0 0
##  [71] 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 1 0 1 1 0 1 0
## [106] 0 0 0 0 0 1 1 1 0 0 0 0 1 1 1 1 0 0 1 1 1 0 1 1 0 0 1 1 0 1 0 1 0 1 0
## [141] 0 0 1 1 0 1 0 0 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 0 0 0 1 0 0 1 1 1 0
## [176] 0 1 1 1 0 1 0 0 0 1 0 0 1 1 0 0 0 0 0 0 0 0 1 0 1
## Levels: 0 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Making the confusion matrix}
\NormalTok{cm =}\StringTok{ }\KeywordTok{table}\NormalTok{(test_set[, }\DecValTok{692}\NormalTok{], y_pred)}
\NormalTok{cm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y_pred
##      0  1
##   0 76 24
##   1 43 57
\end{verbatim}

\hypertarget{linear-svm}{%
\subsubsection{7.2.3 Linear SVM}\label{linear-svm}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Fitting SVM to the training set}
\KeywordTok{library}\NormalTok{(e1071)}
\NormalTok{classifier =}\StringTok{ }\KeywordTok{svm}\NormalTok{(}\DataTypeTok{formula =}\NormalTok{ Liked }\OperatorTok{~}\StringTok{ }\NormalTok{., }
                 \DataTypeTok{data =}\NormalTok{ training_set, }
                 \DataTypeTok{type =} \StringTok{'C-classification'}\NormalTok{, }
                 \DataTypeTok{kernel =} \StringTok{'linear'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in svm.default(x, y, scale = scale, ..., na.action = na.action):
## Variable(s) 'boot' and 'brick' and 'eye' and 'given' and 'legit' and 'mall'
## and 'oven' and 'peanut' and 'pure' and 'scallop' and 'show' and 'tap'
## constant. Cannot scale data.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Predicting the test set results}
\NormalTok{y_pred =}\StringTok{ }\KeywordTok{predict}\NormalTok{(classifier, }\DataTypeTok{newdata =}\NormalTok{ test_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{])}
\NormalTok{y_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   4   9  10  16  17  21  24  33  39  40  41  48  56  58  59  61  63  73 
##   1   1   1   0   1   0   1   0   1   0   0   0   1   0   1   0   1   0 
##  76  82  92  93  98  99 105 112 113 115 116 122 123 142 150 152 154 157 
##   1   0   1   0   0   1   0   0   1   1   0   0   1   0   0   1   0   1 
## 158 159 161 169 182 183 184 188 190 191 193 199 202 203 210 211 217 222 
##   1   1   1   0   0   0   0   1   1   1   1   1   1   0   0   0   1   0 
## 228 239 240 250 251 255 258 262 264 270 272 276 287 292 303 306 314 318 
##   1   1   1   0   1   1   0   0   1   0   1   0   1   0   0   0   0   0 
## 326 328 337 344 345 346 349 351 353 361 363 364 370 375 395 396 397 399 
##   0   1   1   1   0   1   1   0   1   0   1   0   0   0   1   0   0   1 
## 412 413 415 416 430 433 445 446 453 456 466 469 470 473 486 495 496 509 
##   1   0   0   0   1   1   1   1   0   1   1   1   0   1   0   1   0   0 
## 519 521 525 528 531 535 539 545 548 555 560 563 568 570 574 583 586 591 
##   0   1   1   0   1   0   0   0   0   1   0   1   1   0   1   0   1   1 
## 598 606 613 614 618 625 628 633 634 639 641 647 648 653 658 668 674 679 
##   1   1   1   0   0   1   1   0   1   0   1   0   0   1   1   0   1   1 
## 688 694 698 712 715 716 719 730 739 743 752 759 761 768 780 789 795 807 
##   1   1   0   1   1   1   0   1   1   0   1   1   1   1   1   1   0   0 
## 809 811 817 818 821 844 848 849 853 855 863 868 874 882 890 891 892 894 
##   1   0   0   1   0   0   1   0   1   1   0   0   1   0   1   1   1   0 
## 900 905 906 912 915 920 924 931 935 938 939 941 953 956 965 973 977 983 
##   1   1   1   0   0   0   0   1   0   0   1   0   1   0   0   1   0   0 
## 985 996 
##   0   0 
## Levels: 0 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Making the confusion matrix}
\NormalTok{cm =}\StringTok{ }\KeywordTok{table}\NormalTok{(test_set[, }\DecValTok{692}\NormalTok{], y_pred)}
\NormalTok{cm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y_pred
##      0  1
##   0 78 22
##   1 19 81
\end{verbatim}

\hypertarget{kernel-svm}{%
\subsubsection{7.2.4 Kernel SVM}\label{kernel-svm}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Fitting SVM to the training set}
\KeywordTok{library}\NormalTok{(e1071)}
\NormalTok{classifier =}\StringTok{ }\KeywordTok{svm}\NormalTok{(}\DataTypeTok{formula =}\NormalTok{ Liked }\OperatorTok{~}\StringTok{ }\NormalTok{., }
                 \DataTypeTok{data =}\NormalTok{ training_set, }
                 \DataTypeTok{type =} \StringTok{'C-classification'}\NormalTok{, }
                 \DataTypeTok{kernel =} \StringTok{'linear'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in svm.default(x, y, scale = scale, ..., na.action = na.action):
## Variable(s) 'boot' and 'brick' and 'eye' and 'given' and 'legit' and 'mall'
## and 'oven' and 'peanut' and 'pure' and 'scallop' and 'show' and 'tap'
## constant. Cannot scale data.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Predicting the test set results}
\NormalTok{y_pred =}\StringTok{ }\KeywordTok{predict}\NormalTok{(classifier, }\DataTypeTok{newdata =}\NormalTok{ test_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{])}
\NormalTok{y_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   4   9  10  16  17  21  24  33  39  40  41  48  56  58  59  61  63  73 
##   1   1   1   0   1   0   1   0   1   0   0   0   1   0   1   0   1   0 
##  76  82  92  93  98  99 105 112 113 115 116 122 123 142 150 152 154 157 
##   1   0   1   0   0   1   0   0   1   1   0   0   1   0   0   1   0   1 
## 158 159 161 169 182 183 184 188 190 191 193 199 202 203 210 211 217 222 
##   1   1   1   0   0   0   0   1   1   1   1   1   1   0   0   0   1   0 
## 228 239 240 250 251 255 258 262 264 270 272 276 287 292 303 306 314 318 
##   1   1   1   0   1   1   0   0   1   0   1   0   1   0   0   0   0   0 
## 326 328 337 344 345 346 349 351 353 361 363 364 370 375 395 396 397 399 
##   0   1   1   1   0   1   1   0   1   0   1   0   0   0   1   0   0   1 
## 412 413 415 416 430 433 445 446 453 456 466 469 470 473 486 495 496 509 
##   1   0   0   0   1   1   1   1   0   1   1   1   0   1   0   1   0   0 
## 519 521 525 528 531 535 539 545 548 555 560 563 568 570 574 583 586 591 
##   0   1   1   0   1   0   0   0   0   1   0   1   1   0   1   0   1   1 
## 598 606 613 614 618 625 628 633 634 639 641 647 648 653 658 668 674 679 
##   1   1   1   0   0   1   1   0   1   0   1   0   0   1   1   0   1   1 
## 688 694 698 712 715 716 719 730 739 743 752 759 761 768 780 789 795 807 
##   1   1   0   1   1   1   0   1   1   0   1   1   1   1   1   1   0   0 
## 809 811 817 818 821 844 848 849 853 855 863 868 874 882 890 891 892 894 
##   1   0   0   1   0   0   1   0   1   1   0   0   1   0   1   1   1   0 
## 900 905 906 912 915 920 924 931 935 938 939 941 953 956 965 973 977 983 
##   1   1   1   0   0   0   0   1   0   0   1   0   1   0   0   1   0   0 
## 985 996 
##   0   0 
## Levels: 0 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Making the confusion matrix}
\NormalTok{cm =}\StringTok{ }\KeywordTok{table}\NormalTok{(test_set[, }\DecValTok{692}\NormalTok{], y_pred)}
\NormalTok{cm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y_pred
##      0  1
##   0 78 22
##   1 19 81
\end{verbatim}

\hypertarget{naive-bayes}{%
\subsubsection{7.2.5 Naive Bayes}\label{naive-bayes}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Fitting naive Bayes to the training set}
\KeywordTok{library}\NormalTok{(e1071)}
\NormalTok{classifier =}\StringTok{ }\KeywordTok{naiveBayes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ training_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{], }
                        \DataTypeTok{y =}\NormalTok{ training_set}\OperatorTok{$}\NormalTok{Liked)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Predicting the test set results}
\NormalTok{y_pred =}\StringTok{ }\KeywordTok{predict}\NormalTok{(classifier, }\DataTypeTok{newdata =}\NormalTok{ test_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{])}
\NormalTok{y_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1
##  [36] 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
##  [71] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [106] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1
## [141] 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [176] 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## Levels: 0 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Making the confusion matrix}
\NormalTok{cm =}\StringTok{ }\KeywordTok{table}\NormalTok{(test_set[, }\DecValTok{692}\NormalTok{], y_pred)}
\NormalTok{cm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y_pred
##      0  1
##   0  5 95
##   1  4 96
\end{verbatim}

\hypertarget{decision-tree}{%
\subsubsection{7.2.6 Decision Tree}\label{decision-tree}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Fitting the classifier to the training set}
\KeywordTok{library}\NormalTok{(rpart)}
\NormalTok{classifier =}\StringTok{ }\KeywordTok{rpart}\NormalTok{(}\DataTypeTok{formula =}\NormalTok{ Liked }\OperatorTok{~}\StringTok{ }\NormalTok{., }
                   \DataTypeTok{data =}\NormalTok{ training_set)      }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Predicting the Test set results}
\NormalTok{y_pred =}\StringTok{ }\KeywordTok{predict}\NormalTok{(classifier, }\DataTypeTok{newdata =}\NormalTok{ test_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{], }\DataTypeTok{type =} \StringTok{'class'}\NormalTok{)}
\NormalTok{y_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   4   9  10  16  17  21  24  33  39  40  41  48  56  58  59  61  63  73 
##   1   1   1   0   0   0   0   0   0   0   0   1   1   0   1   0   1   0 
##  76  82  92  93  98  99 105 112 113 115 116 122 123 142 150 152 154 157 
##   0   0   0   0   0   1   0   0   1   1   0   0   1   1   0   1   0   0 
## 158 159 161 169 182 183 184 188 190 191 193 199 202 203 210 211 217 222 
##   0   1   0   0   0   0   0   0   1   1   0   1   1   0   0   0   1   0 
## 228 239 240 250 251 255 258 262 264 270 272 276 287 292 303 306 314 318 
##   1   0   0   0   1   1   0   1   1   0   0   0   0   0   0   0   0   1 
## 326 328 337 344 345 346 349 351 353 361 363 364 370 375 395 396 397 399 
##   0   1   0   0   0   1   0   0   0   0   0   0   0   1   1   0   0   1 
## 412 413 415 416 430 433 445 446 453 456 466 469 470 473 486 495 496 509 
##   0   0   0   0   0   1   1   0   1   0   0   1   1   1   0   0   0   0 
## 519 521 525 528 531 535 539 545 548 555 560 563 568 570 574 583 586 591 
##   0   0   1   0   1   0   0   0   0   1   0   1   1   0   0   0   1   1 
## 598 606 613 614 618 625 628 633 634 639 641 647 648 653 658 668 674 679 
##   0   1   0   0   0   1   0   0   0   0   1   0   1   1   1   0   1   1 
## 688 694 698 712 715 716 719 730 739 743 752 759 761 768 780 789 795 807 
##   1   0   0   0   1   1   0   1   1   1   0   1   1   1   1   1   0   0 
## 809 811 817 818 821 844 848 849 853 855 863 868 874 882 890 891 892 894 
##   1   1   0   0   0   0   1   0   1   1   0   0   0   0   0   1   0   0 
## 900 905 906 912 915 920 924 931 935 938 939 941 953 956 965 973 977 983 
##   1   0   1   0   0   0   0   1   0   0   0   0   1   0   0   0   0   0 
## 985 996 
##   0   0 
## Levels: 0 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Making the Confusion Matrix}
\NormalTok{cm =}\StringTok{ }\KeywordTok{table}\NormalTok{(test_set[, }\DecValTok{692}\NormalTok{], y_pred)}
\NormalTok{cm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y_pred
##      0  1
##   0 85 15
##   1 43 57
\end{verbatim}

\hypertarget{random-forest}{%
\subsubsection{7.2.7 Random Forest}\label{random-forest}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Fitting Random Forest Classification to the Training set}
\KeywordTok{library}\NormalTok{(randomForest)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## randomForest 4.6-14
\end{verbatim}

\begin{verbatim}
## Type rfNews() to see new features/changes/bug fixes.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{classifier =}\StringTok{ }\KeywordTok{randomForest}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ training_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{],}
                          \DataTypeTok{y =}\NormalTok{ training_set}\OperatorTok{$}\NormalTok{Liked,}
                          \DataTypeTok{ntree =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Predicting the Test set results}
\NormalTok{y_pred =}\StringTok{ }\KeywordTok{predict}\NormalTok{(classifier, }\DataTypeTok{newdata =}\NormalTok{ test_set[}\OperatorTok{-}\DecValTok{692}\NormalTok{])}
\NormalTok{y_pred}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   4   9  10  16  17  21  24  33  39  40  41  48  56  58  59  61  63  73 
##   1   1   1   0   0   0   0   0   1   0   0   1   1   0   1   0   1   0 
##  76  82  92  93  98  99 105 112 113 115 116 122 123 142 150 152 154 157 
##   0   0   1   0   0   1   0   0   1   1   0   0   1   1   0   1   0   0 
## 158 159 161 169 182 183 184 188 190 191 193 199 202 203 210 211 217 222 
##   1   1   0   0   0   0   0   0   1   1   0   1   1   0   0   0   1   0 
## 228 239 240 250 251 255 258 262 264 270 272 276 287 292 303 306 314 318 
##   1   1   1   0   1   1   0   1   1   0   1   0   0   0   0   0   0   1 
## 326 328 337 344 345 346 349 351 353 361 363 364 370 375 395 396 397 399 
##   0   1   1   0   0   1   0   0   0   0   0   1   0   1   1   0   0   1 
## 412 413 415 416 430 433 445 446 453 456 466 469 470 473 486 495 496 509 
##   1   0   0   1   0   1   1   0   1   0   1   1   1   1   0   0   0   0 
## 519 521 525 528 531 535 539 545 548 555 560 563 568 570 574 583 586 591 
##   0   1   1   0   1   0   0   0   0   1   0   1   1   0   1   1   1   1 
## 598 606 613 614 618 625 628 633 634 639 641 647 648 653 658 668 674 679 
##   1   1   1   0   0   1   0   0   0   0   1   0   1   1   1   1   1   1 
## 688 694 698 712 715 716 719 730 739 743 752 759 761 768 780 789 795 807 
##   1   1   0   0   1   1   0   1   1   0   1   1   1   1   1   1   0   0 
## 809 811 817 818 821 844 848 849 853 855 863 868 874 882 890 891 892 894 
##   1   1   0   0   0   0   1   0   1   1   0   0   1   0   1   1   1   0 
## 900 905 906 912 915 920 924 931 935 938 939 941 953 956 965 973 977 983 
##   1   0   1   0   0   1   0   1   0   0   0   0   1   0   0   0   0   0 
## 985 996 
##   0   0 
## Levels: 0 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Making the Confusion Matrix}
\NormalTok{cm =}\StringTok{ }\KeywordTok{table}\NormalTok{(test_set[, }\DecValTok{692}\NormalTok{], y_pred)}
\NormalTok{cm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y_pred
##      0  1
##   0 78 22
##   1 28 72
\end{verbatim}


\end{document}
